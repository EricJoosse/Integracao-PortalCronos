Manual Upgrade dos Ambientes de Produção de 2.8.5 para 3.0.0 
============================================================

1. Apenas no caso do servidor do monitoramento:
	 - Conectar como cronostech
     - No Windows Explorer alterar a opção para exibir arquivos de sistema 
       (desmarcar "Hide protected operating system files") temporariamente


2. Fazer exatamente na seguinte sequência:
   (i)   Em todos os casos exceto JR Distribuição / Windows 10:
         Verificar se o arquivo .bat e o .jar atual estão em uso: 
         verificar o horário da última e da próxima execução no Task Scheduler 
         e verificar no taskmgr.exe se o JRE está rodando ainda. 
         Esperar até o JRE terminou.
   
   (ii)  Em todos os casos (incluindo no caso JR Distribuição / Windows 10):
 		   - Adicionar "exit" seguida por uma linha em branco no início do arquivo 
 		     Job15a15minOfertamentoJava_Windows.bat no servidor do fornecedor. 
 		     (NÃO renomear Job15a15minOfertamentoJava_Windows.bat para evitar que o Scheduler 
              possivelmente se perde comprometendo os derrubamentos automáticos dos JRE´s travados)

   (iii) Apenas no caso de instalação no servidor da JR Distribuição (Windows 10):
	        a. Primeiro verificar no diretório C:\ProgramData\PortalCronos\Logs\Local\ 
	           se o Integrador está ofertando no momento e ficar esperando até ele terminar 
	           o último passo (a atualização do arquivo TemposExecução.log)
 
		    b. Matar o processo JRE 1.8.0_92
		 		 
		   
3. (i)  Copiar o arquivo novo integr-fornecedor-3.0.0.jar do instalador para o servidor do fornecedor.
   (ii) Apagar a versão anterior integr-fornecedor-*.*.*.jar.
 
4. Em todos os casos:
   Atualizar os seguintes arquivos no servidor do fornecedor:
	- /bin/Versao.bat 
	- /bin/CaminhoJRE.bat
	- Job15a15minOfertamentoJava_Windows.bat 
 
5. Apenas no caso do APS Cloud: 
	- Copiar do projeto Eclipse para o servidor do APS Cloud:
		- AdicionarFornecedorNuvem.bat
		- conf/TemplateNuvemAPS.properties
	- Apagar o Task Schedule atual
	- Backup do arquivo config .properties da Marizpan
	- Apagar o arquivo "conf/Integração Fornecedor - Portal Cronos.properties"
	- No caso que o arquivo "C:\Arquivos de Programas PC\Manual Manutenção TI.txt" foi removido provisoriamente, 
	  colocar de volta
	- No arquivo "C:\Arquivos de Programas PC\Manual Manutenção TI.txt":
	    - Gerar pelo "GeradorNaHoraManualTI_COM_PARAMETRO_IdFornecedor.launch" 
	      e copiar do raiz do projeto Eclipse para o servidor do APS Cloud, 
	      ou: 
			- Substituir: - O servidor da Marizpan que está hospedando este serviço está desligado?
			     por:     - O servidor nuvem da APS Cloud que está hospedando este serviço está desligado? 

			- Substituir:
					  - A senha do usuário ws-marizpan do site do Portal Cronos foi alterada no site? 
					    Neste caso verifica se a mesma foi atualizada também no seguinte arquivo de configuração: 
					    C:\Arquivos de Programas PC\Integração Fornecedor - Portal Cronos\conf\Integração Fornecedor - Portal Cronos.properties
			     Por:
					  - A(s) senha(s) de um ou mais usuários ws-marizpan, ws-atacamax, etc, do site do Portal Cronos foi(foram) alterada(s) no site? 
					    Neste caso verifica se a mesma foi atualizada também no seguinte arquivo de configuração: 
					    C:\Arquivos de Programas PC\Integração Fornecedor - Portal Cronos\conf\Integração APS - Portal Cronos.<NomeFornecedor>.properties
			- Substituir:
					No caso que você mesmo consegue resolver o problema: 
					  1. Favor verificar após 15 minutos se o serviço atualizou o arquivo
					     "C:/ProgramData/PortalCronos/Logs/Local/TemposExecução.log" no final do arquivo.
			     Por:
					No caso que você mesmo consegue resolver o problema: 
					  1. Favor verificar após 15 minutos se o serviço atualizou o arquivo
					     "C:/ProgramData/PortalCronos/Logs/Local/TemposExecução.<NomeFornecedor>.log" no final do arquivo.
	- No menu de Windows "Iniciar" > "Portal Cronos" adicionar o subdir novo "Integração APS/WinThor/..."
	- No menu de Windows "Iniciar" > "Portal Cronos" > "Integração APS":
		- Criar o seguinte atalho:
			- "C:\Arquivos de Programas PC\AdicionarFornecedorNuvem.bat"
			- Renomear para "Adicionar Cliente novo"
			- Ícone de pasta + maizinha verde, veja exemplo na máquina .181 no Azure
		- No caso qu o atalho "Manual Manutenção TI" foi removido provisoriamente, colocar de volta
		- No caso qu o atalho "Manual Manutenção TI" NÃO foi removido e ainda está no menu, 
		  mover este atalho de  "Iniciar" > "Portal Cronos" para "Iniciar" > "Portal Cronos" > "Integração APS"
	- Adicionar cliente novo "Marizpan"
	- Copiar o conteúdo do backup do config da Marizpan para "Integração APS - Portal Cronos.Marizpan.properties"
	- No menu de Windows "Iniciar" > "Portal Cronos" > "Integração APS":
		- Verificar se o seguinte atalho foi criado pela tela "Adicionar Cliente novo":
			- "C:\Arquivos de Programas PC\Integração Fornecedor - Portal Cronos\conf\Integração APS - Portal Cronos.Marizpan.properties"
			- Atalho renomeado para "Configurações Marizpan"
			- Ícone de Configurações, veja exemplo na máquina .181 no Azure
	- Alterar o dir C:\Arquivos de Programas PC\ para Hidden e System File, executando o seguinte 
	  na tela preta de DOS: 
	    	cd\
	    	attrib "Arquivos de Programas PC" +S +H	    
	  (é necessário para evitar cópias hackeadas e erradas dos arquivos de configuração, 
	   sem ter criado um Windows Task Schedule) 
	- Adicionar cliente novo "Atacamax"


6. Em todos os casos de servidores de PRODUÇÃO (não no servidor de Homologação do APS Cloud): 
     - Verificar a memória RAM livre no servidor do fornecedor (sem contar meu JVM).
		    - Preencher isso no f[i].MemoriaRamLivre = "" no FornecedorRepositorio   
	 - Observação: no servidor de monitoramento o serviço + JVM ocupa 60 MB de memória
	 
 
7. Remover "exit" e a linha em branco no início do arquivo Job15a15minOfertamentoJava_Windows.bat
   no servidor do fornecedor (Sempre como último passo no AnyDesk para forçar 100 % conclusão do upgrade).

8. Em todos os casos: 
     - Acompanhar 15 minutos se o Integrador começa executar automaticamente
     
9. Apenas no caso do servidor do monitoramento: 
     (i)  No Windows Explorer voltar a opção para não exibir arquivos de sistema 
          (marcar "Hide protected operating system files")
     (ii) Fechar o Windows Explorer e abrir novamente
     
     
10. (i)   Atualizar a versão do .jar no arquivo "FornecedorRepositorio.java" para o fornecedor que foi atualizado
    (ii)  Compilar o arquivo .jar
    (iii) Atualizar o arquivo .jar no servidor de monitoramento (não precisa atualizar o servidor do fornecedor)
          esperando o processamento atual terminar primeiro
   
